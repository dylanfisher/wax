!function(a,b){if("object"==typeof exports&&exports)b(exports);else{var c={};b(c),"function"==typeof define&&define.amd?define(c):a.Mustache=c}}(this,function(a){function b(a,b){return n.call(a,b)}function c(a){return!b(o,a)}function d(a){return"function"==typeof a}function e(a){return a.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function f(a){return String(a).replace(/[&<>"'\/]/g,function(a){return r[a]})}function g(a){if(!q(a)||2!==a.length)throw new Error("Invalid tags: "+a);return[new RegExp(e(a[0])+"\\s*"),new RegExp("\\s*"+e(a[1]))]}function h(b,d){function f(){if(A&&!B)for(;z.length;)delete y[z.pop()];else z=[];A=!1,B=!1}d=d||a.tags,b=b||"","string"==typeof d&&(d=d.split(t));for(var h,l,m,n,o,p,q=g(d),r=new k(b),x=[],y=[],z=[],A=!1,B=!1;!r.eos();){if(h=r.pos,m=r.scanUntil(q[0]))for(var C=0,D=m.length;D>C;++C)n=m.charAt(C),c(n)?z.push(y.length):B=!0,y.push(["text",n,h,h+1]),h+=1,"\n"===n&&f();if(!r.scan(q[0]))break;if(A=!0,l=r.scan(w)||"name",r.scan(s),"="===l?(m=r.scanUntil(u),r.scan(u),r.scanUntil(q[1])):"{"===l?(m=r.scanUntil(new RegExp("\\s*"+e("}"+d[1]))),r.scan(v),r.scanUntil(q[1]),l="&"):m=r.scanUntil(q[1]),!r.scan(q[1]))throw new Error("Unclosed tag at "+r.pos);if(o=[l,m,h,r.pos],y.push(o),"#"===l||"^"===l)x.push(o);else if("/"===l){if(p=x.pop(),!p)throw new Error('Unopened section "'+m+'" at '+h);if(p[1]!==m)throw new Error('Unclosed section "'+p[1]+'" at '+h)}else"name"===l||"{"===l||"&"===l?B=!0:"="===l&&(q=g(d=m.split(t)))}if(p=x.pop())throw new Error('Unclosed section "'+p[1]+'" at '+r.pos);return j(i(y))}function i(a){for(var b,c,d=[],e=0,f=a.length;f>e;++e)b=a[e],b&&("text"===b[0]&&c&&"text"===c[0]?(c[1]+=b[1],c[3]=b[3]):(d.push(b),c=b));return d}function j(a){for(var b,c,d=[],e=d,f=[],g=0,h=a.length;h>g;++g)switch(b=a[g],b[0]){case"#":case"^":e.push(b),f.push(b),e=b[4]=[];break;case"/":c=f.pop(),c[5]=b[2],e=f.length>0?f[f.length-1][4]:d;break;default:e.push(b)}return d}function k(a){this.string=a,this.tail=a,this.pos=0}function l(a,b){this.view=null==a?{}:a,this.cache={".":this.view},this.parent=b}function m(){this.cache={}}var n=RegExp.prototype.test,o=/\S/,p=Object.prototype.toString,q=Array.isArray||function(a){return"[object Array]"===p.call(a)},r={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},s=/\s*/,t=/\s+/,u=/\s*=/,v=/\s*\}/,w=/#|\^|\/|>|\{|&|=|!/;k.prototype.eos=function(){return""===this.tail},k.prototype.scan=function(a){var b=this.tail.match(a);if(b&&0===b.index){var c=b[0];return this.tail=this.tail.substring(c.length),this.pos+=c.length,c}return""},k.prototype.scanUntil=function(a){var b,c=this.tail.search(a);switch(c){case-1:b=this.tail,this.tail="";break;case 0:b="";break;default:b=this.tail.substring(0,c),this.tail=this.tail.substring(c)}return this.pos+=b.length,b},l.prototype.push=function(a){return new l(a,this)},l.prototype.lookup=function(a){var b;if(a in this.cache)b=this.cache[a];else{for(var c=this;c;){if(a.indexOf(".")>0){b=c.view;for(var e=a.split("."),f=0;null!=b&&f<e.length;)b=b[e[f++]]}else b=c.view[a];if(null!=b)break;c=c.parent}this.cache[a]=b}return d(b)&&(b=b.call(this.view)),b},m.prototype.clearCache=function(){this.cache={}},m.prototype.parse=function(a,b){var c=this.cache,d=c[a];return null==d&&(d=c[a]=h(a,b)),d},m.prototype.render=function(a,b,c){var d=this.parse(a),e=b instanceof l?b:new l(b);return this.renderTokens(d,e,c,a)},m.prototype.renderTokens=function(b,c,e,f){function g(a){return k.render(a,c,e)}for(var h,i,j="",k=this,l=0,m=b.length;m>l;++l)switch(h=b[l],h[0]){case"#":if(i=c.lookup(h[1]),!i)continue;if(q(i))for(var n=0,o=i.length;o>n;++n)j+=this.renderTokens(h[4],c.push(i[n]),e,f);else if("object"==typeof i||"string"==typeof i)j+=this.renderTokens(h[4],c.push(i),e,f);else if(d(i)){if("string"!=typeof f)throw new Error("Cannot use higher-order sections without the original template");i=i.call(c.view,f.slice(h[3],h[5]),g),null!=i&&(j+=i)}else j+=this.renderTokens(h[4],c,e,f);break;case"^":i=c.lookup(h[1]),(!i||q(i)&&0===i.length)&&(j+=this.renderTokens(h[4],c,e,f));break;case">":if(!e)continue;i=d(e)?e(h[1]):e[h[1]],null!=i&&(j+=this.renderTokens(this.parse(i),c,e,i));break;case"&":i=c.lookup(h[1]),null!=i&&(j+=i);break;case"name":i=c.lookup(h[1]),null!=i&&(j+=a.escape(i));break;case"text":j+=h[1]}return j},a.name="mustache.js",a.version="0.8.1",a.tags=["{{","}}"];var x=new m;a.clearCache=function(){return x.clearCache()},a.parse=function(a,b){return x.parse(a,b)},a.render=function(a,b,c){return x.render(a,b,c)},a.to_html=function(b,c,e,f){var g=a.render(b,c,e);return d(f)?(f(g),void 0):g},a.escape=f,a.Scanner=k,a.Context=l,a.Writer=m}),function(a,b){!function(c){"function"==typeof define&&define.amd?define(["jquery"],c):a.sammy=b.Sammy=c(a)}(function(a){var c,d="([^/]+)",e=/:([\w\d]+)/g,f=/\?([^#]*)?$/,g=function(a){return Array.prototype.slice.call(a)},h=function(a){return"[object Function]"===Object.prototype.toString.call(a)},i=function(a){return"[object Array]"===Object.prototype.toString.call(a)},j=function(a){return"[object RegExp]"===Object.prototype.toString.call(a)},k=function(a){return decodeURIComponent((a||"").replace(/\+/g," "))},l=encodeURIComponent,m=function(a){return String(a).replace(/&(?!\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},n=function(a){return function(){return this.route.apply(this,[a].concat(Array.prototype.slice.call(arguments)))}},o={},p=!!b.history&&!!history.pushState,q=[];return c=function(){var b,d,e=g(arguments);return c.apps=c.apps||{},0===e.length||e[0]&&h(e[0])?c.apply(c,["body"].concat(e)):"string"==typeof(d=e.shift())?(b=c.apps[d]||new c.Application,b.element_selector=d,e.length>0&&a.each(e,function(a,c){b.use(c)}),b.element_selector!=d&&delete c.apps[d],c.apps[b.element_selector]=b,b):void 0},c.VERSION="0.7.4",c.addLogger=function(a){q.push(a)},c.log=function(){var b=g(arguments);b.unshift("["+Date()+"]"),a.each(q,function(a,d){d.apply(c,b)})},"undefined"!=typeof b.console?h(b.console.log.apply)?c.addLogger(function(){b.console.log.apply(b.console,arguments)}):c.addLogger(function(){b.console.log(arguments)}):"undefined"!=typeof console&&c.addLogger(function(){console.log.apply(console,arguments)}),a.extend(c,{makeArray:g,isFunction:h,isArray:i}),c.Object=function(b){return a.extend(this,b||{})},a.extend(c.Object.prototype,{escapeHTML:m,h:m,toHash:function(){var b={};return a.each(this,function(a,c){h(c)||(b[a]=c)}),b},toHTML:function(){var b="";return a.each(this,function(a,c){h(c)||(b+="<strong>"+a+"</strong> "+c+"<br />")}),b},keys:function(a){var b=[];for(var c in this)(!h(this[c])||!a)&&b.push(c);return b},has:function(b){return this[b]&&""!==a.trim(this[b].toString())},join:function(){var a=g(arguments),b=a.shift();return a.join(b)},log:function(){c.log.apply(c,arguments)},toString:function(b){var c=[];return a.each(this,function(a,d){(!h(d)||b)&&c.push('"'+a+'": '+d.toString())}),"Sammy.Object: {"+c.join(",")+"}"}}),c.targetIsThisWindow=function(c){var d=a(c.target).attr("target");return d&&d!==b.name&&"_self"!==d?"_blank"===d?!1:"top"===d&&b===b.top?!0:!1:!0},c.DefaultLocationProxy=function(a,b){this.app=a,this.is_native=!1,this.has_history=p,this._startPolling(b)},c.DefaultLocationProxy.fullPath=function(a){var b=a.toString().match(/^[^#]*(#.+)$/),c=b?b[1]:"";return[a.pathname,a.search,c].join("")},a.extend(c.DefaultLocationProxy.prototype,{bind:function(){var d=this,e=this.app,f=c.DefaultLocationProxy;a(b).bind("hashchange."+this.app.eventNamespace(),function(a,c){d.is_native===!1&&!c&&(d.is_native=!0,b.clearInterval(f._interval),f._interval=null),e.trigger("location-changed")}),p&&!e.disable_push_state&&(a(b).bind("popstate."+this.app.eventNamespace(),function(){e.trigger("location-changed")}),a(document).delegate("a","click.history-"+this.app.eventNamespace(),function(a){if(!(a.isDefaultPrevented()||a.metaKey||a.ctrlKey)){var g=f.fullPath(this);return this.hostname==b.location.hostname&&e.lookupRoute("get",g)&&c.targetIsThisWindow(a)?(a.preventDefault(),d.setLocation(g),!1):void 0}})),f._bindings||(f._bindings=0),f._bindings++},unbind:function(){a(b).unbind("hashchange."+this.app.eventNamespace()),a(b).unbind("popstate."+this.app.eventNamespace()),a(document).undelegate("a","click.history-"+this.app.eventNamespace()),c.DefaultLocationProxy._bindings--,c.DefaultLocationProxy._bindings<=0&&(b.clearInterval(c.DefaultLocationProxy._interval),c.DefaultLocationProxy._interval=null)},getLocation:function(){return c.DefaultLocationProxy.fullPath(b.location)},setLocation:function(a){if(/^([^#\/]|$)/.test(a)&&(a=p&&!this.app.disable_push_state?"/"+a:"#!/"+a),a!=this.getLocation()){if(!p||this.app.disable_push_state||!/^\//.test(a))return b.location=a;history.pushState({path:a},b.title,a),this.app.trigger("location-changed")}},_startPolling:function(d){var e=this;if(!c.DefaultLocationProxy._interval){d||(d=10);var f=function(){var d=e.getLocation();("undefined"==typeof c.DefaultLocationProxy._last_location||d!=c.DefaultLocationProxy._last_location)&&b.setTimeout(function(){a(b).trigger("hashchange",[!0])},0),c.DefaultLocationProxy._last_location=d};f(),c.DefaultLocationProxy._interval=b.setInterval(f,d)}}}),c.Application=function(a){var b=this;this.routes={},this.listeners=new c.Object({}),this.arounds=[],this.befores=[],this.namespace=(new Date).getTime()+"-"+parseInt(1e3*Math.random(),10),this.context_prototype=function(){c.EventContext.apply(this,arguments)},this.context_prototype.prototype=new c.EventContext,h(a)&&a.apply(this,[this]),this._location_proxy||this.setLocationProxy(new c.DefaultLocationProxy(this,this.run_interval_every)),this.debug&&this.bindToAllEvents(function(a,c){b.log(b.toString(),a.cleaned_type,c||{})})},c.Application.prototype=a.extend({},c.Object.prototype,{ROUTE_VERBS:["get","post","put","delete"],APP_EVENTS:["run","unload","lookup-route","run-route","route-found","event-context-before","event-context-after","changed","error","check-form-submission","redirect","location-changed"],_last_route:null,_location_proxy:null,_running:!1,element_selector:"body",debug:!1,raise_errors:!1,run_interval_every:50,disable_push_state:!1,template_engine:null,toString:function(){return"Sammy.Application:"+this.element_selector},$element:function(b){return b?a(this.element_selector).find(b):a(this.element_selector)},use:function(){var a=g(arguments),b=a.shift(),d=b||"";try{a.unshift(this),"string"==typeof b&&(d="Sammy."+b,b=c[b]),b.apply(this,a)}catch(e){"undefined"==typeof b?this.error("Plugin Error: called use() but plugin ("+d.toString()+") is not defined",e):h(b)?this.error("Plugin Error",e):this.error("Plugin Error: called use() but '"+d.toString()+"' is not a function",e)}return this},setLocationProxy:function(a){var b=this._location_proxy;this._location_proxy=a,this.isRunning()&&(b&&b.unbind(),this._location_proxy.bind())},log:function(){c.log.apply(c,Array.prototype.concat.apply([this.element_selector],arguments))},route:function(b,c){var f,g,i=this,j=[],k=Array.prototype.slice.call(arguments,2);if(0===k.length&&h(c)&&(c=b,k=[c],b="any"),b=b.toLowerCase(),c.constructor==String){for(e.lastIndex=0;null!==(g=e.exec(c));)j.push(g[1]);c=new RegExp(c.replace(e,d)+"$")}return a.each(k,function(a,b){"string"==typeof b&&(k[a]=i[b])}),f=function(a){var b={verb:a,path:c,callback:k,param_names:j};i.routes[a]=i.routes[a]||[],i.routes[a].push(b)},"any"===b?a.each(this.ROUTE_VERBS,function(a,b){f(b)}):f(b),this},get:n("get"),post:n("post"),put:n("put"),del:n("delete"),any:n("any"),mapRoutes:function(b){var c=this;return a.each(b,function(a,b){c.route.apply(c,b)}),this},eventNamespace:function(){return["sammy-app",this.namespace].join("-")},bind:function(a,b,c){var d=this;"undefined"==typeof c&&(c=b);var e=function(){var a,b,e;a=arguments[0],e=arguments[1],e&&e.context?(b=e.context,delete e.context):b=new d.context_prototype(d,"bind",a.type,e,a.target),a.cleaned_type=a.type.replace(d.eventNamespace(),""),c.apply(b,[a,e])};return this.listeners[a]||(this.listeners[a]=[]),this.listeners[a].push(e),this.isRunning()&&this._listen(a,e),this},trigger:function(a,b){return this.$element().trigger([a,this.eventNamespace()].join("."),[b]),this},refresh:function(){return this.last_location=null,this.trigger("location-changed"),this},before:function(a,b){return h(a)&&(b=a,a={}),this.befores.push([a,b]),this},after:function(a){return this.bind("event-context-after",a)},around:function(a){return this.arounds.push(a),this},onComplete:function(a){return this._onComplete=a,this},isRunning:function(){return this._running},helpers:function(b){return a.extend(this.context_prototype.prototype,b),this},helper:function(a,b){return this.context_prototype.prototype[a]=b,this},run:function(d){if(this.isRunning())return!1;var e=this;return a.each(this.listeners.toHash(),function(b,c){a.each(c,function(a,c){e._listen(b,c)})}),this.trigger("run",{start_url:d}),this._running=!0,this.last_location=null,!/\#(.+)/.test(this.getLocation())&&"undefined"!=typeof d&&this.setLocation(d),this._checkLocation(),this._location_proxy.bind(),this.bind("location-changed",function(){e._checkLocation()}),this.bind("submit",function(b){if(!c.targetIsThisWindow(b))return!0;var d=e._checkFormSubmission(a(b.target).closest("form"));return d===!1?b.preventDefault():!1}),a(b).bind("unload",function(){e.unload()}),this.trigger("changed")},unload:function(){if(!this.isRunning())return!1;var b=this;return this.trigger("unload"),this._location_proxy.unbind(),this.$element().unbind("submit").removeClass(b.eventNamespace()),a.each(this.listeners.toHash(),function(c,d){a.each(d,function(a,d){b._unlisten(c,d)})}),this._running=!1,this},destroy:function(){return this.unload(),delete c.apps[this.element_selector],this},bindToAllEvents:function(b){var c=this;return a.each(this.APP_EVENTS,function(a,d){c.bind(d,b)}),a.each(this.listeners.keys(!0),function(d,e){-1==a.inArray(e,c.APP_EVENTS)&&c.bind(e,b)}),this},routablePath:function(a){return a.replace(f,"")},lookupRoute:function(a,b){var c,d,e=this,f=!1,g=0;if("undefined"!=typeof this.routes[a])for(c=this.routes[a].length;c>g;g++)if(d=this.routes[a][g],e.routablePath(b).match(d.path)){f=d;break}return f},runRoute:function(b,c,d,e){var f,g,h,i,j,l,m,n,o=this,p=this.lookupRoute(b,c);if(this.debug&&this.log("runRoute",[b,c].join(" ")),this.trigger("run-route",{verb:b,path:c,params:d}),"undefined"==typeof d&&(d={}),a.extend(d,this._parseQueryString(c)),p){this.trigger("route-found",{route:p}),null!==(m=p.path.exec(this.routablePath(c)))&&(m.shift(),a.each(m,function(a,b){p.param_names[a]?d[p.param_names[a]]=k(b):(d.splat||(d.splat=[]),d.splat.push(k(b)))})),f=new this.context_prototype(this,b,c,d,e),h=this.arounds.slice(0),i=this.befores.slice(0),l=[f],d.splat&&(l=l.concat(d.splat)),g=function(){for(var a,b,c;i.length>0;)if(j=i.shift(),o.contextMatchesOptions(f,j[0])&&(a=j[1].apply(f,[f]),a===!1))return!1;return o.last_route=p,f.trigger("event-context-before",{context:f}),"function"==typeof p.callback&&(p.callback=[p.callback]),p.callback&&p.callback.length&&(b=-1,c=function(){b++,p.callback[b]?a=p.callback[b].apply(f,l):o._onComplete&&typeof("function"===o._onComplete)&&o._onComplete(f)},l.push(c),c()),f.trigger("event-context-after",{context:f}),a},a.each(h.reverse(),function(a,b){var c=g;g=function(){return b.apply(f,[c])}});try{n=g()}catch(q){this.error(["500 Error",b,c].join(" "),q)}return n}return this.notFound(b,c)},contextMatchesOptions:function(b,c,d){var e=c;if(("string"==typeof e||j(e))&&(e={path:e}),"undefined"==typeof d&&(d=!0),a.isEmptyObject(e))return!0;if(i(e.path)){var f,g,h,k;for(f=[],g=0,k=e.path.length;k>g;g+=1)h=a.extend({},e,{path:e.path[g]}),f.push(this.contextMatchesOptions(b,h));var l=a.inArray(!0,f)>-1?!0:!1;return d?l:!l}if(e.only)return this.contextMatchesOptions(b,e.only,!0);if(e.except)return this.contextMatchesOptions(b,e.except,!1);var m=!0,n=!0;return e.path&&(j(e.path)||(e.path=new RegExp(e.path.toString()+"$")),m=e.path.test(b.path)),e.verb&&(n="string"==typeof e.verb?e.verb===b.verb:e.verb.indexOf(b.verb)>-1),d?n&&m:!n||!m},getLocation:function(){return this._location_proxy.getLocation()},setLocation:function(a){return this._location_proxy.setLocation(a)},swap:function(a,b){var c=this.$element().html(a);return h(b)&&b(a),c},templateCache:function(a,b){return"undefined"!=typeof b?o[a]=b:o[a]},clearTemplateCache:function(){return o={}},notFound:function(a,b){var c=this.error(["404 Not Found",a,b].join(" "));return"get"===a?c:!0},error:function(a,b){if(b||(b=new Error),b.message=[a,b.message].join(" "),this.trigger("error",{message:b.message,error:b}),this.raise_errors)throw b;this.log(b.message,b)},_checkLocation:function(){var a,b;return a=this.getLocation(),this.last_location&&"get"==this.last_location[0]&&this.last_location[1]==a||(this.last_location=["get",a],b=this.runRoute("get",a)),b},_getFormVerb:function(b){var c,d,e=a(b);return d=e.find('input[name="_method"]'),d.length>0&&(c=d.val()),c||(c=e[0].getAttribute("method")),c&&""!==c||(c="get"),a.trim(c.toString().toLowerCase())},_checkFormSubmission:function(b){var c,d,e,f,g;return this.trigger("check-form-submission",{form:b}),c=a(b),d=c.attr("action")||"",e=this._getFormVerb(c),this.debug&&this.log("_checkFormSubmission",c,d,e),"get"===e?(f=this._serializeFormParams(c),""!==f&&(d+="?"+f),this.setLocation(d),g=!1):(f=a.extend({},this._parseFormParams(c)),g=this.runRoute(e,d,f,b.get(0))),"undefined"==typeof g?!1:g},_serializeFormParams:function(a){var b,c="",d=a.serializeArray();if(d.length>0)for(c=this._encodeFormPair(d[0].name,d[0].value),b=1;b<d.length;b++)c=c+"&"+this._encodeFormPair(d[b].name,d[b].value);return c},_encodeFormPair:function(a,b){return l(a)+"="+l(b)},_parseFormParams:function(a){var b,c={},d=a.serializeArray();for(b=0;b<d.length;b++)c=this._parseParamPair(c,d[b].name,d[b].value);return c},_parseQueryString:function(a){var b,c,d,e,g={};if(b=a.match(f),b&&b[1])for(c=b[1].split("&"),e=0;e<c.length;e++)d=c[e].split("="),g=this._parseParamPair(g,k(d[0]),k(d[1]||""));return g},_parseParamPair:function(a,b,c){return"undefined"!=typeof a[b]?i(a[b])?a[b].push(c):a[b]=[a[b],c]:a[b]=c,a},_listen:function(a,b){return this.$element().bind([a,this.eventNamespace()].join("."),b)},_unlisten:function(a,b){return this.$element().unbind([a,this.eventNamespace()].join("."),b)}}),c.RenderContext=function(a){this.event_context=a,this.callbacks=[],this.previous_content=null,this.content=null,this.next_engine=!1,this.waiting=!1},c.RenderContext.prototype=a.extend({},c.Object.prototype,{then:function(a){if(!h(a)){if(!("string"==typeof a&&a in this.event_context))return this;var c=this.event_context[a];a=function(a){return c.apply(this.event_context,[a])}}var d=this;return this.waiting?this.callbacks.push(a):(this.wait(),b.setTimeout(function(){var b=a.apply(d,[d.content,d.previous_content]);b!==!1&&d.next(b)},0)),this},wait:function(){this.waiting=!0},next:function(a){this.waiting=!1,"undefined"!=typeof a&&(this.previous_content=this.content,this.content=a),this.callbacks.length>0&&this.then(this.callbacks.shift())},load:function(b,c,d){var e=this;return this.then(function(){var f,g,i;return h(c)?(d=c,c={}):c=a.extend({},c),d&&this.then(d),"string"==typeof b?(i=b.match(/\.json$/)||c.json,f=i?c.cache===!0:c.cache!==!1,e.next_engine=e.event_context.engineFor(b),delete c.cache,delete c.json,c.engine&&(e.next_engine=c.engine,delete c.engine),f&&(g=this.event_context.app.templateCache(b))?g:(this.wait(),a.ajax(a.extend({url:b,data:{},dataType:i?"json":"text",type:"get",success:function(a){f&&e.event_context.app.templateCache(b,a),e.next(a)}},c)),!1)):b.nodeType?b.innerHTML:b.selector?(e.next_engine=b.attr("data-engine"),c.clone===!1?b.remove()[0].innerHTML.toString():b[0].innerHTML.toString()):void 0})},loadPartials:function(a){var b;if(a){this.partials=this.partials||{};for(b in a)(function(b,c){b.load(a[c]).then(function(a){this.partials[c]=a})})(this,b)}return this},render:function(a,b,c,d){return h(a)&&!b?this.then(a):(h(b)?(d=c,c=b,b=null):c&&!h(c)&&(d=c,c=null),this.loadPartials(d).load(a).interpolate(b,a).then(c))},partial:function(a,b,c,d){return h(c)?this.render(a,b,d).swap(c):h(b)?this.render(a,{},c).swap(b):this.render(a,b,c).swap()},send:function(){var a=this,b=g(arguments),c=b.shift();return i(b[0])&&(b=b[0]),this.then(function(){return b.push(function(b){a.next(b)}),a.wait(),c.apply(c,b),!1})},collect:function(b,c,d){var e=this,f=function(){h(b)&&(c=b,b=this.content);var d=[],f=!1;return a.each(b,function(a,b){var g=c.apply(e,[a,b]);return g.jquery&&1==g.length&&(g=g[0],f=!0),d.push(g),g}),f?d:d.join("")};return d?f():this.then(f)},renderEach:function(b,c,d,e){return i(c)&&(e=d,d=c,c=null),this.load(b).then(function(f){var g=this;return d||(d=i(this.previous_content)?this.previous_content:[]),e?(a.each(d,function(a,d){var h={},i=this.next_engine||b;c?h[c]=d:h=d,e(d,g.event_context.interpolate(f,h,i))}),void 0):this.collect(d,function(a,d){var e={},g=this.next_engine||b;return c?e[c]=d:e=d,this.event_context.interpolate(f,e,g)},!0)})},interpolate:function(a,b,c){var d=this;return this.then(function(e,f){!a&&f&&(a=f),this.next_engine&&(b=this.next_engine,this.next_engine=!1);var g=d.event_context.interpolate(e,a,b,this.partials);return c?f+g:g})},swap:function(a){return this.then(function(b){return this.event_context.swap(b,a),b}).trigger("changed",{})},appendTo:function(b){return this.then(function(c){a(b).append(c)}).trigger("changed",{})},prependTo:function(b){return this.then(function(c){a(b).prepend(c)}).trigger("changed",{})},replace:function(b){return this.then(function(c){a(b).html(c)}).trigger("changed",{})},trigger:function(a,b){return this.then(function(c){return"undefined"==typeof b&&(b={content:c}),this.event_context.trigger(a,b),c})}}),c.EventContext=function(a,b,d,e,f){this.app=a,this.verb=b,this.path=d,this.params=new c.Object(e),this.target=f},c.EventContext.prototype=a.extend({},c.Object.prototype,{$element:function(){return this.app.$element(g(arguments).shift())},engineFor:function(a){var b,c=this;return h(a)?a:(a=(a||c.app.template_engine).toString(),(b=a.match(/\.([^\.\?\#]+)$/))&&(a=b[1]),a&&h(c[a])?c[a]:c.app.template_engine?this.engineFor(c.app.template_engine):function(a){return a})},interpolate:function(a,b,c,d){return this.engineFor(c).apply(this,[a,b,d])},render:function(a,b,d,e){return new c.RenderContext(this).render(a,b,d,e)},renderEach:function(a,b,d,e){return new c.RenderContext(this).renderEach(a,b,d,e)},load:function(a,b,d){return new c.RenderContext(this).load(a,b,d)},loadPartials:function(a){return new c.RenderContext(this).loadPartials(a)},partial:function(a,b,d,e){return new c.RenderContext(this).partial(a,b,d,e)},send:function(){var a=new c.RenderContext(this);return a.send.apply(a,arguments)},redirect:function(){var b,c=g(arguments),d=this.app.getLocation(),e=c.length;if(e>1){for(var f=0,h=[],i=[],j={},k=!1;e>f;f++)"string"==typeof c[f]?h.push(c[f]):(a.extend(j,c[f]),k=!0);if(b=h.join("/"),k){for(var l in j)i.push(this.app._encodeFormPair(l,j[l]));b+="?"+i.join("&")}}else b=c[0];this.trigger("redirect",{to:b}),this.app.last_location=[this.verb,this.path],this.app.setLocation(b),new RegExp(b).test(d)&&this.app.trigger("location-changed")},trigger:function(a,b){return"undefined"==typeof b&&(b={}),b.context||(b.context=this),this.app.trigger(a,b)},eventNamespace:function(){return this.app.eventNamespace()},swap:function(a,b){return this.app.swap(a,b)},notFound:function(){return this.app.notFound(this.verb,this.path)},json:function(b){return a.parseJSON(b)},toString:function(){return"Sammy.EventContext: "+[this.verb,this.path,this.params].join(" ")}}),c})}(jQuery,window),$("#test").on("click",function(){loader($(this)),getData.api("get_page/?id=2",function(a){a=a.page,$("#ajax-here").html("this post title = "+a.title+"<br/>and CONTENT = "+a.content+"<br/>and a DATE = "+a.date)})});var getData=function(){var a="/wax/api/",b=function(b,c){$.getJSON(a+b,function(a){c(a),$(".loading").remove()})};return{api:b}}(),loader=function(a){var b='<div class="loading">loading...</div>';a.append(b)};